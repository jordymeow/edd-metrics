!function(t){var s={};function r(e){if(s[e])return s[e].exports;var a=s[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=s,r.d=function(e,a,t){r.o(e,a)||Object.defineProperty(e,a,{enumerable:!0,get:t})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(a,e){if(1&e&&(a=r(a)),8&e)return a;if(4&e&&"object"==typeof a&&a&&a.__esModule)return a;var t=Object.create(null);if(r.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:a}),2&e&&"string"!=typeof a)for(var s in a)r.d(t,s,function(e){return a[e]}.bind(null,s));return t},r.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(a,"a",a),a},r.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},r.p="",r(r.s=0)}([function(e,a){var r,n,s,o;r=window,n=document,s=jQuery,o={init:function(){o.compare_temp_2=r.eddMetrics.compare_string_2,o.revenue=r.eddMetrics.revenue,o.downloads=r.eddMetrics.downloads,o.doCal()},doCal:function(){new Calendar({element:s(".metrics-datepicker"),presets:[{label:"Last 30 days",start:moment().subtract(29,"days"),end:moment()},{label:"This month",start:moment().startOf("month"),end:moment().endOf("month")},{label:"Last month",start:moment().subtract(1,"month").startOf("month"),end:moment().subtract(1,"month").endOf("month")},{label:"Last 7 days",start:moment().subtract(6,"days"),end:moment()},{label:"Last 3 months",start:moment(this.latest_date).subtract(3,"month").startOf("month"),end:moment(this.latest_date).subtract(1,"month").endOf("month")}],earliest_date:"January 1, 2006",latest_date:moment(),start_date:moment().subtract(29,"days"),end_date:moment(),callback:o.callback}).calendarSaveDates()},callback:function(){var e={action:"metrics_batch_1",start:moment(this.start_date).format("LL"),end:moment(this.end_date).format("LL")},a='<div id="circleG"><div id="circleG_1" class="circleG"></div><div id="circleG_2" class="circleG"></div><div id="circleG_3" class="circleG"></div></div>';s(".edd-metrics-box h2").html(a),s(".edd-metrics-box .bottom-text span").html("").removeClass(),s(this.element[0]).hasClass("metrics-detail")?(s(".edd-metrics-chart-wrapper").append(a),s.post(r.ajaxurl,e,o.detailResponse).then(function(){e.action="metrics_batch_2",s.post(r.ajaxurl,e,o.detailResponse_2)}).fail(function(){console.warn("ajax error")})):s.post(r.ajaxurl,e,o.dashResponse).then(function(){e.action="metrics_batch_2",s.post(r.ajaxurl,e,o.batch2response)}).fail(function(){console.warn("ajax error")})},dashResponse:function(e){var a=JSON.parse(e),t=r.eddMetrics.compare_string+" "+a.dates.num_days+" "+r.eddMetrics.days;s("#revenue").html(a.earnings.total),s("#revenue-compare").addClass(a.earnings.compare.classes),s("#revenue-compare span").html(a.earnings.compare.percentage+t).removeClass().addClass(a.earnings.compare.classes),s("#sales").html(a.sales.count),s("#sales-compare").addClass(a.sales.compare.classes),s("#sales-compare span").html(a.sales.compare.percentage+t).removeClass().addClass(a.sales.compare.classes),s("#avgpercust").html(a.earnings.avgpercust.total),s("#avgpercust-compare").addClass(a.earnings.avgpercust.compare.classes),s("#avgpercust-compare span").html(a.earnings.avgpercust.compare.percentage+t).removeClass().addClass(a.earnings.avgpercust.compare.classes),s("#refunds").html(a.earnings.refunds.count),s("#refund-amount").html(a.earnings.refunds.losses),s("#refunds-compare").addClass(a.earnings.refunds.compare.classes),s("#refunds-compare span").html(a.earnings.refunds.compare.percentage+t).removeClass().addClass(a.earnings.refunds.compare.classes),void 0!==a.lineChart&&o.doLineChart(a.lineChart)},batch2response:function(e){var a=JSON.parse(e),t=r.eddMetrics.compare_string+" "+a.dates.num_days+" "+r.eddMetrics.days;s("#earnings-today").html(a.earnings.detail.today),s("#renewals").length&&(s("#renewals").html(a.renewals.count),s("#renewal-amount").html(a.renewals.earnings),s("#renewals-compare").addClass(a.renewals.compare.classes),s("#renewals-compare span").html(a.renewals.compare.percentage+t).removeClass().addClass(a.renewals.compare.classes)),s("#subscriptions").length&&(s("#subscriptions").html(a.subscriptions.number.count),s("#subscriptions-compare").addClass(a.subscriptions.number.compare.classes),s("#subscriptions-compare span").html(a.subscriptions.number.compare.percentage+t).removeClass().addClass(a.subscriptions.number.compare.classes),s("#recurring-revenue").html(a.subscriptions.earnings.total),s("#recurring-revenue-30").html(a.subscriptions.earnings30)),s("#discounts").html(a.discounts.now.amount),s("#discounts-count").html(a.discounts.now.count),s("#discounts-compare").addClass(a.discounts.compare.classes),s("#discounts-compare span").html(a.discounts.compare.percentage+t).removeClass().addClass(a.discounts.compare.classes),s("#commissions").length&&(s("#commissions").html(a.commissions.count),s("#commissions-amount").html(a.commissions.earnings))},detailResponse:function(e){var a=JSON.parse(e);switch(o.getQueryVariable("metric")){case"revenue":s("#revenue").html(a.earnings.total),s("#revenue-compare").addClass(a.earnings.compare.classes),s("#revenue-compare span").html(a.earnings.compare.percentage+o.compare_temp_2).removeClass().addClass(a.earnings.compare.classes),s(".detail-compare-first").html(a.earnings.compare.total),s("#monthly h2").html(a.earnings.avgmonthly.earnings),s("#new-customers h2").html(a.earnings.avgpercust.current_customers),s("#new-customers span").html("This period"),s(".detail-compare-first").html(a.earnings.compare.total),s("#box-4 .bottom-text span").html(a.earnings.compare.percentage+"%")}o.doLineChart(a.lineChart),s(".edd-metrics-chart-wrapper #circleG").remove()},detailResponse_2:function(e){var a=JSON.parse(e);switch(o.getQueryVariable("metric")){case"revenue":s("#revenue-6mocompare").addClass(a.earnings.detail.sixmoago.classes),s("#revenue-6mocompare span").html(a.earnings.detail.sixmoago.compare+o.compare_temp_2).removeClass().addClass(a.earnings.detail.sixmoago.classes),s(".detail-compare-second").html(a.earnings.detail.sixmoago.total),s(".detail-compare-third").html(a.earnings.detail.twelvemoago.total),s("#revenue-12mocompare").addClass(a.earnings.detail.twelvemoago.classes),s("#revenue-12mocompare span").html(a.earnings.detail.twelvemoago.compare+o.compare_temp_2).removeClass().addClass(a.earnings.detail.twelvemoago.classes),s("#earnings-today h2").html(a.earnings.detail.today),s("#earnings-this-month h2").html(a.earnings.detail.this_month),s("#renewal-rate h2").html(a.yearly_renewal_rate.percent+"%"),s("#yearly-renewal-compare span").html("Last "+a.yearly_renewal_rate.period+" days"),s("#box-5 .bottom-text span").html(a.earnings.detail.sixmoago.compare+"%"),s(".detail-compare-second").html(a.earnings.detail.sixmoago.total),s(".detail-compare-third").html(a.earnings.detail.twelvemoago.total)}o.doDownloadChart(a.pieChart),o.doGatewayChart(a.earnings.gateways)},getQueryVariable:function(e){for(var a=r.location.search.substring(1).split("&"),t=0;t<a.length;t++){var s=a[t].split("=");if(s[0]==e)return s[1]}return!1},doLineChart:function(e){o.lineChart&&o.lineChart.destroy();var a={labels:e.labels,datasets:[{label:o.revenue,fill:!0,lineTension:0,backgroundColor:"#edfbed",borderColor:"#009900",borderWidth:3,borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"round",pointBorderColor:"#009900",pointBackgroundColor:"#fff",pointBorderWidth:3,pointHoverRadius:5,pointHoverBackgroundColor:"#009900",pointHoverBorderColor:"#009900",pointHoverBorderWidth:3,pointRadius:5,pointHitRadius:10,data:e.earnings,spanGaps:!1}]},t=n.getElementById("metrics-line-chart"),s=n.getElementById("metrics-line-chart-tiny");null!==t&&(o.lineChart=new Chart(t,{type:"line",data:a,options:{scales:{xAxes:[{display:!1,stacked:!0}]}}})),null!==s&&(a.datasets[0].borderWidth=2,a.datasets[0].pointBorderWidth=2,a.datasets[0].pointHoverRadius=3,a.datasets[0].pointHoverBorderWidth=2,a.datasets[0].pointRadius=3,o.lineChart=new Chart(s,{type:"line",data:a,options:{scales:{xAxes:[{display:!1,stacked:!0}]}}}))},doDownloadChart:function(e){o.downloadChart&&o.downloadChart.destroy();var a={labels:e.labels,datasets:[{label:o.downloads,data:e.earnings,backgroundColor:["#225378","#1695A3","#1fa739","#EB7F00","#EB4B4D","#EBA945","#663300","#79EB65"],hoverBackgroundColor:["#225378","#1695A3","#1fa739","#EB7F00","#EB4B4D","#EBA945","#663300","#79EB65"]}]},t=n.getElementById("metrics-piechart-by-download");o.downloadChart=new Chart(t,{type:"pie",data:a})},doGatewayChart:function(e){o.gatewayChart&&o.gatewayChart.destroy();var a={labels:e.labels,datasets:[{label:o.downloads,data:e.earnings,backgroundColor:["#225378","#1695A3","#1fa739","#EB7F00","#EB4B4D","#EBA945","#663300","#79EB65"],hoverBackgroundColor:["#225378","#1695A3","#1fa739","#EB7F00","#EB4B4D","#EBA945","#663300","#79EB65"]}]},t=n.getElementById("metrics-piechart-by-gateway");o.gatewayChart=new Chart(t,{type:"pie",data:a})}},jQuery(n).ready(o.init)}]);